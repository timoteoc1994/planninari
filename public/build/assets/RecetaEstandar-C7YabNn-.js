import{d as v,k as F,x as h,c as D,o as d,w as E,a as e,e as i,f as p,l as u,p as c,F as j,h as L,t as a,j as g,u as o,Q as k}from"./app-dG6Nd7Y9.js";import{_ as $}from"./AppLayout-Da1CQfCP.js";import{S as V}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"py-8 max-w-4xl mx-auto space-y-6"},A={class:"flex items-center gap-4"},R={class:"overflow-x-auto"},T={class:"w-full bg-white rounded shadow"},z={class:"px-4 py-2"},G={class:"px-4 py-2"},Q={class:"px-4 py-2"},H={class:"px-4 py-2"},I={class:"px-4 py-2"},J={class:"px-4 py-2 space-x-2"},K=["onClick"],O=["onClick"],W={key:0},X={class:"bg-white p-6 rounded shadow w-full max-w-lg"},Y={key:0,class:"text-red-600 text-sm"},Z={key:0,class:"text-red-600 text-sm"},ee={class:"flex justify-end space-x-2 mt-4"},te=["disabled"],oe={class:"bg-white p-6 rounded shadow w-full max-w-lg"},se={key:0,class:"text-red-600 text-sm"},re={key:0,class:"text-red-600 text-sm"},le={class:"flex justify-end space-x-2 mt-4"},ne=["disabled"],ce={__name:"RecetaEstandar",props:{proyecto_id:Number,productos:Array},setup(b){const w=v(""),C=F(()=>{const n=w.value.toLowerCase();return b.productos.filter(t=>t.ref.toLowerCase().includes(n)||t.nombre_producto.toLowerCase().includes(n))}),m=v(!1),s=h({nombre_producto:"",detalle:"",presentacion:"",precio_venta:""});function P(){s.reset(),s.clearErrors(),s.nombre_producto="",s.detalle="",s.presentacion="",s.precio_venta="",m.value=!0}function x(){m.value=!1,s.reset(),s.clearErrors(),s.nombre_producto="",s.detalle="",s.presentacion="",s.precio_venta=""}function B(){s.post(route("recetaestandar.store",{id:b.proyecto_id}),{onSuccess:()=>{x(),k.reload({only:["productos"]})}})}const f=v(!1),_=v(null),r=h({nombre_producto:"",detalle:"",presentacion:"",precio_venta:""});function S(n){_.value=n,r.reset(),r.clearErrors(),r.nombre_producto=n.nombre_producto,r.detalle=n.detalle,r.presentacion=n.presentacion,r.precio_venta=n.precio_venta,f.value=!0}function y(){f.value=!1,_.value=null,r.reset(),r.clearErrors(),r.nombre_producto="",r.detalle="",r.presentacion="",r.precio_venta=""}function U(){r.put(route("recetaestandar.update",{id:b.proyecto_id,recetaestandar:_.value.id}),{onSuccess:()=>{y(),k.reload({only:["productos"]})}})}function M(n){V.fire({title:"¿Eliminar este producto?",text:`"${n.nombre_producto}"`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#e3342f",cancelButtonColor:"#6c757d",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&k.delete(route("recetaestandar.destroy",{id:b.proyecto_id,recetaestandar:n.id}),{onSuccess:()=>{V.fire("Eliminado","El producto fue eliminado.","success")}})})}return document.addEventListener("keydown",n=>{n.key==="Escape"&&(m.value&&x(),f.value&&y())}),(n,t)=>(d(),D($,{title:"Receta Estándar"},{header:E(()=>t[9]||(t[9]=[e("h2",{class:"font-semibold text-xl text-gray-800"}," Receta Estándar – Productos Desarrollados ",-1)])),default:E(()=>[e("div",q,[e("div",A,[u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>w.value=l),type:"text",placeholder:"Buscar...",class:"border w-full rounded p-2 flex-grow focus:outline-none focus:ring"},null,512),[[c,w.value]]),e("button",{onClick:P,class:"px-4 py-2 bg-green-600 text-white rounded shadow hover:bg-green-700 transition"}," Crear ")]),e("div",R,[e("table",T,[t[11]||(t[11]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left"},"REF."),e("th",{class:"px-4 py-2 text-left"},"Nombre"),e("th",{class:"px-4 py-2 text-left"},"Detalle"),e("th",{class:"px-4 py-2 text-left"},"Presentación"),e("th",{class:"px-4 py-2 text-left"},"Precio Venta"),e("th",{class:"px-4 py-2 text-left"},"Acciones")])],-1)),e("tbody",null,[(d(!0),i(j,null,L(C.value,l=>(d(),i("tr",{key:l.id,class:"border-t hover:bg-gray-50"},[e("td",z,a(l.ref),1),e("td",G,a(l.nombre_producto),1),e("td",Q,a(l.detalle),1),e("td",H,a(l.presentacion),1),e("td",I," $"+a(parseFloat(l.precio_venta||0).toFixed(2)),1),e("td",J,[e("button",{onClick:N=>S(l),class:"px-2 py-1 bg-yellow-500 text-white rounded hover:bg-yellow-600 transition text-sm"}," Editar ",8,K),e("button",{onClick:N=>M(l),class:"px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition text-sm"}," Eliminar ",8,O)])]))),128)),C.value.length?p("",!0):(d(),i("tr",W,t[10]||(t[10]=[e("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500"}," No se encontró ningún producto. ",-1)])))])])])]),m.value?(d(),i("div",{key:0,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",onClick:g(x,["self"])},[e("div",X,[t[16]||(t[16]=e("h3",{class:"text-lg font-semibold mb-4"},"Nuevo Producto",-1)),e("form",{onSubmit:g(B,["prevent"]),class:"space-y-4"},[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm"},"Nombre *",-1)),u(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>o(s).nombre_producto=l),required:"",class:"w-full border rounded p-2"},null,512),[[c,o(s).nombre_producto]]),o(s).errors.nombre_producto?(d(),i("p",Y,a(o(s).errors.nombre_producto),1)):p("",!0)]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm"},"Presentación",-1)),u(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>o(s).presentacion=l),class:"w-full border rounded p-2"},null,512),[[c,o(s).presentacion]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm"},"Detalle",-1)),u(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=l=>o(s).detalle=l),class:"w-full border rounded p-2",rows:"2"},null,512),[[c,o(s).detalle]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm"},"Precio Venta *",-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>o(s).precio_venta=l),type:"number",step:"0.01",required:"",class:"w-full border rounded p-2"},null,512),[[c,o(s).precio_venta]]),o(s).errors.precio_venta?(d(),i("p",Z,a(o(s).errors.precio_venta),1)):p("",!0)]),e("div",ee,[e("button",{type:"button",onClick:x,class:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300"}," Cancelar "),e("button",{type:"submit",disabled:o(s).processing,class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700"},a(o(s).processing?"Guardando...":"Guardar"),9,te)])],32)])])):p("",!0),f.value?(d(),i("div",{key:1,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",onClick:g(y,["self"])},[e("div",oe,[t[21]||(t[21]=e("h3",{class:"text-lg font-semibold mb-4"},"Editar Producto",-1)),e("form",{onSubmit:g(U,["prevent"]),class:"space-y-4"},[e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm"},"Nombre *",-1)),u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>o(r).nombre_producto=l),required:"",class:"w-full border rounded p-2"},null,512),[[c,o(r).nombre_producto]]),o(r).errors.nombre_producto?(d(),i("p",se,a(o(r).errors.nombre_producto),1)):p("",!0)]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm"},"Presentación",-1)),u(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>o(r).presentacion=l),class:"w-full border rounded p-2"},null,512),[[c,o(r).presentacion]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm"},"Detalle",-1)),u(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=l=>o(r).detalle=l),class:"w-full border rounded p-2",rows:"2"},null,512),[[c,o(r).detalle]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm"},"Precio Venta *",-1)),u(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>o(r).precio_venta=l),type:"number",step:"0.01",required:"",class:"w-full border rounded p-2"},null,512),[[c,o(r).precio_venta]]),o(r).errors.precio_venta?(d(),i("p",re,a(o(r).errors.precio_venta),1)):p("",!0)]),e("div",le,[e("button",{type:"button",onClick:y,class:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300"}," Cancelar "),e("button",{type:"submit",disabled:o(r).processing,class:"px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600"},a(o(r).processing?"Actualizando...":"Actualizar"),9,ne)])],32)])])):p("",!0)]),_:1}))}};export{ce as default};
