import{d as f,y as I,k,x as w,c as J,o as a,w as F,a as e,e as l,f as m,t as r,j as C,l as P,u as c,p as A,F as G,h as U,Q as x}from"./app-CMmN75Yt.js";import{_ as K}from"./AppLayout-CYw2QiOb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"py-12"},W={key:0,class:"max-w-4xl mx-auto sm:px-6 lg:px-8 mb-4"},X={class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded"},Y={key:1,class:"max-w-4xl mx-auto sm:px-6 lg:px-8 mb-4"},Z={class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"},ee={class:"max-w-4xl mx-auto sm:px-6 lg:px-8 bg-white p-8 rounded shadow"},oe={class:"mb-4"},te={class:"mb-4"},se={class:"p-4 bg-slate-100 rounded-lg"},ae={key:0,class:"space-y-2"},le={class:"flex-1"},re={class:"text-sm text-gray-600"},ie={class:"text-gray-900"},de={class:"flex space-x-2"},ce=["onClick"],ne=["onClick"],ue={key:1,class:"text-gray-500 text-sm"},pe={class:"mb-4"},ve={class:"p-4 bg-slate-100 rounded-lg"},be={key:0,class:"space-y-2"},me={class:"flex-1"},xe={class:"text-sm text-gray-600"},fe={class:"text-gray-900"},ye={class:"flex space-x-2"},ge=["onClick"],he=["onClick"],_e={key:1,class:"text-gray-500 text-sm"},ke={key:0,class:"mt-2"},we=["href"],Ce={type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 mt-6"},Pe={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Ae={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},Me={class:"mt-3"},je={class:"text-lg font-medium text-gray-900 mb-4"},Ee={class:"mb-4"},Ne={class:"flex justify-end space-x-2"},$e={type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"},qe={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Ve={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},ze={class:"mt-3"},De={class:"text-lg font-medium text-gray-900 mb-4"},Be={class:"mb-4"},Se={class:"flex justify-end space-x-2"},Fe={type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"},Le={__name:"ActividadesClave",props:{actividadesclave:Object,procesocomercial:Array,procesoproductivo:Array,proyecto_id:Number},setup(d){var D,B;const i=d,y=f(!1),g=f(!1),n=f(null),u=f(null),M=I(),j=k(()=>{var s;return(s=M.props.flash)==null?void 0:s.success}),E=k(()=>{var s;return(s=M.props.flash)==null?void 0:s.error}),p=w({actividad_clave:((D=i.actividadesclave)==null?void 0:D.actividad_clave)??"",archivo:((B=i.actividadesclave)==null?void 0:B.archivo)??"",proyecto_id:i.proyecto_id,archivo:null}),v=w({paso:"",proyecto_id:i.proyecto_id}),b=w({paso:"",proyecto_id:i.proyecto_id}),N=k(()=>!!i.actividadesclave);function Q(){N.value?(p.forceFormData=!0,x.post(route("actividadesclave.update",i.actividadesclave.id),p.data())):p.post(route("actividadesclave.store"))}function L(){n.value?x.post(route("proceso-productivo.update",n.value.id),v.data()):v.post(route("proceso-productivo.store")),q()}function O(){u.value?x.post(route("proceso-comercial.update",u.value.id),b.data()):b.post(route("proceso-comercial.store")),z()}function $(s=null){n.value=s,v.paso=s?s.paso:"",y.value=!0}function q(){y.value=!1,n.value=null,v.reset()}function T(s){confirm("¿Estás seguro de que quieres eliminar este paso?")&&x.delete(route("proceso-productivo.destroy",s))}function V(s=null){u.value=s,b.paso=s?s.paso:"",g.value=!0}function z(){g.value=!1,u.value=null,b.reset()}function H(s){confirm("¿Estás seguro de que quieres eliminar este paso?")&&x.delete(route("proceso-comercial.destroy",s))}return(s,o)=>(a(),J(K,{title:"Actividades Clave"},{header:F(()=>o[6]||(o[6]=[e("div",{class:"flex justify-between items-center"},[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Actividades Clave ")],-1)])),default:F(()=>{var S;return[e("div",R,[j.value?(a(),l("div",W,[e("div",X,r(j.value),1)])):m("",!0),E.value?(a(),l("div",Y,[e("div",Z,r(E.value),1)])):m("",!0),e("div",ee,[e("form",{onSubmit:C(Q,["prevent"])},[e("div",oe,[o[7]||(o[7]=e("label",{class:"block mb-1 font-semibold"},"Actividades clave",-1)),P(e("textarea",{"onUpdate:modelValue":o[0]||(o[0]=t=>c(p).actividad_clave=t),class:"w-full border rounded px-3 py-2",required:""},null,512),[[A,c(p).actividad_clave]])]),e("div",te,[o[8]||(o[8]=e("label",{class:"block mb-1 font-semibold"},"Proceso productivo",-1)),e("div",se,[e("button",{type:"button",onClick:o[1]||(o[1]=t=>$()),class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 mb-4"}," Nuevo paso "),d.procesoproductivo&&d.procesoproductivo.length>0?(a(),l("div",ae,[(a(!0),l(G,null,U(d.procesoproductivo,(t,h)=>(a(),l("div",{key:t.id,class:"flex items-center justify-between p-3 bg-white rounded border"},[e("div",le,[e("span",re,"Paso "+r(h+1)+":",1),e("p",ie,r(t.paso),1)]),e("div",de,[e("button",{type:"button",onClick:_=>$(t),class:"text-blue-600 hover:text-blue-800 text-sm"}," Editar ",8,ce),e("button",{type:"button",onClick:_=>T(t.id),class:"text-red-600 hover:text-red-800 text-sm"}," Eliminar ",8,ne)])]))),128))])):(a(),l("div",ue," No hay pasos registrados aún. "))])]),e("div",pe,[o[9]||(o[9]=e("label",{class:"block mb-1 font-semibold"},"Proceso comercial",-1)),e("div",ve,[e("button",{type:"button",onClick:o[2]||(o[2]=t=>V()),class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 mb-4"}," Nuevo paso "),d.procesocomercial&&d.procesocomercial.length>0?(a(),l("div",be,[(a(!0),l(G,null,U(d.procesocomercial,(t,h)=>(a(),l("div",{key:t.id,class:"flex items-center justify-between p-3 bg-white rounded border"},[e("div",me,[e("span",xe,"Paso "+r(h+1)+":",1),e("p",fe,r(t.paso),1)]),e("div",ye,[e("button",{type:"button",onClick:_=>V(t),class:"text-blue-600 hover:text-blue-800 text-sm"}," Editar ",8,ge),e("button",{type:"button",onClick:_=>H(t.id),class:"text-red-600 hover:text-red-800 text-sm"}," Eliminar ",8,he)])]))),128))])):(a(),l("div",_e," No hay pasos registrados aún. "))])]),e("div",null,[o[10]||(o[10]=e("label",{class:"block font-semibold"},"Adjunte un archivo (max: 5mb)",-1)),e("input",{type:"file",class:"input",onChange:o[3]||(o[3]=t=>c(p).archivo=t.target.files[0])},null,32),(S=i.actividadesclave)!=null&&S.archivo?(a(),l("div",ke,[e("a",{class:"text-blue-600 hover:underline",href:`/storage/${i.actividadesclave.archivo}`,target:"_blank"}," Ver archivo adjunto ",8,we)])):m("",!0)]),e("button",Ce,r(N.value?"Actualizar":"Guardar"),1)],32)])]),y.value?(a(),l("div",Pe,[e("div",Ae,[e("div",Me,[e("h3",je,r(n.value?"Editar":"Nuevo")+" Paso - Proceso Productivo ",1),e("form",{onSubmit:C(L,["prevent"])},[e("div",Ee,[o[11]||(o[11]=e("label",{for:"paso_productivo",class:"block text-sm font-medium text-gray-700"}," Descripción del paso ",-1)),P(e("input",{id:"paso_productivo",type:"text","onUpdate:modelValue":o[4]||(o[4]=t=>c(v).paso=t),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[A,c(v).paso]])]),e("div",Ne,[e("button",{type:"button",onClick:q,class:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400"}," Cancelar "),e("button",$e,r(n.value?"Actualizar":"Guardar"),1)])],32)])])])):m("",!0),g.value?(a(),l("div",qe,[e("div",Ve,[e("div",ze,[e("h3",De,r(u.value?"Editar":"Nuevo")+" Paso - Proceso Comercial ",1),e("form",{onSubmit:C(O,["prevent"])},[e("div",Be,[o[12]||(o[12]=e("label",{for:"paso_comercial",class:"block text-sm font-medium text-gray-700"}," Descripción del paso ",-1)),P(e("input",{id:"paso_comercial",type:"text","onUpdate:modelValue":o[5]||(o[5]=t=>c(b).paso=t),class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm px-3 py-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[A,c(b).paso]])]),e("div",Se,[e("button",{type:"button",onClick:z,class:"px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400"}," Cancelar "),e("button",Fe,r(u.value?"Actualizar":"Guardar"),1)])],32)])])])):m("",!0)]}),_:1}))}};export{Le as default};
