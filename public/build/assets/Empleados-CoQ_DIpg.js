import{d as f,k as v,x as T,c as U,o as n,w as N,a as e,e as i,f as h,l as m,p as y,F as S,h as B,t as r,j as F,u as a,v as j,Q as g}from"./app-dG6Nd7Y9.js";import{_ as z}from"./AppLayout-Da1CQfCP.js";import{S as $}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"py-8 max-w-4xl mx-auto space-y-6"},D={class:"flex items-center gap-4"},G={class:"overflow-x-auto"},O={class:"w-full table-auto border-collapse bg-white rounded shadow mb-8"},Q={class:"px-4 py-2"},H={class:"px-4 py-2"},J={class:"px-4 py-2"},K={class:"px-4 py-2"},P={class:"px-4 py-2 space-x-2"},W=["onClick"],X=["onClick"],Y={key:0},Z={class:"overflow-x-auto"},ee={class:"w-full table-auto border-collapse bg-white rounded shadow"},te={class:"px-4 py-2"},oe={class:"px-4 py-2"},se={class:"px-4 py-2"},le={class:"px-4 py-2"},re={class:"px-4 py-2 space-x-2"},ae=["onClick"],ne=["onClick"],ie={key:0},de={class:"border-t font-semibold bg-gray-50"},pe={class:"px-4 py-2"},ue={class:"bg-white p-6 rounded shadow-lg w-full max-w-md"},ce={class:"text-lg font-semibold mb-4 text-center"},me={class:"flex items-center space-x-2"},be={class:"flex justify-end space-x-2 mt-4"},xe=["disabled"],fe={__name:"Empleados",props:{proyecto_id:{type:Number,required:!0},empleados:{type:Array,required:!0}},setup(A){const d=A,b=f(""),w=v(()=>{const l=b.value.toLowerCase().trim();return d.empleados.filter(t=>!t.es_empresario).filter(t=>t.nombre.toLowerCase().includes(l))}),k=v(()=>{const l=b.value.toLowerCase().trim();return d.empleados.filter(t=>t.es_empresario).filter(t=>!l||t.nombre.toLowerCase().includes(l))}),L=v(()=>d.empleados.reduce((l,t)=>l+parseFloat(t.salario_real),0)),s=T({nombre:"",salario_nominal:"",beneficios_pct:"",es_empresario:!1}),u=f(!1),p=f(!1),x=f(null);function M(){s.reset(),s.clearErrors(),p.value=!1,x.value=null,u.value=!0}function C(l){p.value=!0,x.value=l.id,s.reset(),s.clearErrors(),s.nombre=l.nombre,s.salario_nominal=l.salario_nominal,s.beneficios_pct=l.beneficios_pct,s.es_empresario=!!l.es_empresario,u.value=!0}function c(){u.value=!1,p.value=!1,x.value=null,s.reset(),s.clearErrors()}function V(){s.post(route("empleados.store",{id:d.proyecto_id}),{onSuccess:c,onFinish:()=>g.reload({only:["empleados"]})})}function q(){s.put(route("empleados.update",{id:d.proyecto_id,empleado:x.value}),{onSuccess:c,onFinish:()=>g.reload({only:["empleados"]})})}function E(l){$.fire({title:"¿Eliminar empleado?",text:l.nombre,icon:"warning",showCancelButton:!0,confirmButtonColor:"#e3342f",cancelButtonColor:"#6c757d",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&g.delete(route("empleados.destroy",{id:d.proyecto_id,empleado:l.id}),{onSuccess:()=>$.fire("Eliminado","","success")})})}return document.addEventListener("keydown",l=>{l.key==="Escape"&&u.value&&c()}),(l,t)=>(n(),U(z,{title:"Empleados"},{header:N(()=>t[6]||(t[6]=[e("h2",{class:"text-center text-2xl font-bold"},"Empleados y Salarios",-1)])),default:N(()=>[e("div",R,[e("div",D,[m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>b.value=o),type:"text",placeholder:"Buscar...",class:"border w-full rounded p-2 focus:outline-none focus:ring"},null,512),[[y,b.value]]),e("button",{onClick:M,class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition"}," Crear ")]),e("div",G,[e("table",O,[t[8]||(t[8]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left"},"Nombre"),e("th",{class:"px-4 py-2 text-left"},"Salario Nominal"),e("th",{class:"px-4 py-2 text-left"},"% Beneficios"),e("th",{class:"px-4 py-2 text-left"},"Salario Real"),e("th",{class:"px-4 py-2 text-left"},"Acciones")])],-1)),e("tbody",null,[(n(!0),i(S,null,B(w.value,o=>(n(),i("tr",{key:o.id,class:"border-t hover:bg-gray-50"},[e("td",Q,r(o.nombre),1),e("td",H,"$"+r(Number(o.salario_nominal).toFixed(2)),1),e("td",J,r(Number(o.beneficios_pct).toFixed(2))+"%",1),e("td",K,"$"+r(Number(o.salario_real).toFixed(2)),1),e("td",P,[e("button",{onClick:_=>C(o),class:"px-2 py-1 bg-yellow-500 text-white rounded hover:bg-yellow-600 text-sm"},"Editar",8,W),e("button",{onClick:_=>E(o),class:"px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-sm"},"Eliminar",8,X)])]))),128)),w.value.length?h("",!0):(n(),i("tr",Y,t[7]||(t[7]=[e("td",{colspan:"5",class:"text-center py-8 text-gray-500"}," No hay empleados. ",-1)])))])])]),e("div",Z,[e("table",ee,[t[12]||(t[12]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left"},"Nombre (Empresario)"),e("th",{class:"px-4 py-2 text-left"},"Salario Nominal"),e("th",{class:"px-4 py-2 text-left"},"% Beneficios"),e("th",{class:"px-4 py-2 text-left"},"Salario Real"),e("th",{class:"px-4 py-2 text-left"},"Acciones")])],-1)),e("tbody",null,[(n(!0),i(S,null,B(k.value,o=>(n(),i("tr",{key:o.id,class:"border-t hover:bg-gray-50"},[e("td",te,r(o.nombre),1),e("td",oe,"$"+r(Number(o.salario_nominal).toFixed(2)),1),e("td",se,r(Number(o.beneficios_pct).toFixed(2))+"%",1),e("td",le,"$"+r(Number(o.salario_real).toFixed(2)),1),e("td",re,[e("button",{onClick:_=>C(o),class:"px-2 py-1 bg-yellow-500 text-white rounded hover:bg-yellow-600 text-sm"},"Editar",8,ae),e("button",{onClick:_=>E(o),class:"px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-sm"},"Eliminar",8,ne)])]))),128)),k.value.length?h("",!0):(n(),i("tr",ie,t[9]||(t[9]=[e("td",{colspan:"5",class:"text-center py-4 text-gray-500"}," No hay empresario definido. ",-1)]))),e("tr",de,[t[10]||(t[10]=e("td",{colspan:"3",class:"px-4 py-2 text-center"},"TOTAL SALARIOS",-1)),e("td",pe,"$"+r(Number(L.value).toFixed(2)),1),t[11]||(t[11]=e("td",null,null,-1))])])])])]),u.value?(n(),i("div",{key:0,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",onClick:F(c,["self"])},[e("div",ue,[e("h3",ce,r(p.value?"Editar Empleado":"Nuevo Empleado"),1),e("form",{onSubmit:t[5]||(t[5]=F(o=>p.value?q():V(),["prevent"])),class:"space-y-4"},[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm mb-1"},"Nombre *",-1)),m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>a(s).nombre=o),type:"text",required:"",class:"w-full border rounded p-2"},null,512),[[y,a(s).nombre]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm mb-1"},"Salario Nominal *",-1)),m(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>a(s).salario_nominal=o),type:"number",step:"0.01",required:"",class:"w-full border rounded p-2"},null,512),[[y,a(s).salario_nominal]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm mb-1"},"% Beneficios *",-1)),m(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>a(s).beneficios_pct=o),type:"number",step:"0.01",required:"",class:"w-full border rounded p-2"},null,512),[[y,a(s).beneficios_pct]])]),e("div",me,[m(e("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=o=>a(s).es_empresario=o),id:"es_empresario",class:"form-checkbox"},null,512),[[j,a(s).es_empresario]]),t[16]||(t[16]=e("label",{for:"es_empresario",class:"text-sm"},"Es empresario",-1))]),e("div",be,[e("button",{type:"button",onClick:c,class:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300"},"Cancelar"),e("button",{type:"submit",disabled:a(s).processing,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"},r(p.value?a(s).processing?"Actualizando…":"Actualizar":a(s).processing?"Guardando…":"Guardar"),9,xe)])],32)])])):h("",!0)]),_:1}))}},ge=I(fe,[["__scopeId","data-v-26f0cdcd"]]);export{ge as default};
